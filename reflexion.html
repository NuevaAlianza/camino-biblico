<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Reflexión con selección</title>
<style>
  body { font-family: Arial, sans-serif; padding: 2rem; background:#fef6e4; }
  #pregunta-container { margin-top: 1rem; background:#fff8f0; padding:1rem 1.5rem; border-radius:12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display:none; max-width: 600px;}
  button { padding: 0.5rem 1rem; font-size: 1rem; margin-top: 0.5rem; border-radius: 8px; background:#ffb703; border:none; cursor:pointer; }
  button:hover { background:#fb8500; color:#fff; }
  #respuesta { margin-top: 1rem; font-style: italic; display:none; color:#7f5539; }
</style>
</head>
<body>

<h1>Reflexión por temas</h1>
<label for="tema-select">Elige un tema:</label>
<select id="tema-select">
  <option value="">-- Elige un tema --</option>
</select>

<div id="pregunta-container">
  <div id="pregunta-texto"></div>
  <button id="mostrar-respuesta-btn">Mostrar respuesta</button>
  <div id="respuesta"></div>
  <button id="btn-siguiente">Siguiente pregunta</button>
</div>

<script>
let datos = {};
let preguntasActuales = [];
let indiceActual = 0;

document.addEventListener('DOMContentLoaded', async () => {
  const select = document.getElementById('tema-select');
  const contenedor = document.getElementById('pregunta-container');
  const preguntaTexto = document.getElementById('pregunta-texto');
  const btnSiguiente = document.getElementById('btn-siguiente');
  const btnMostrarRespuesta = document.getElementById('mostrar-respuesta-btn');
  const divRespuesta = document.getElementById('respuesta');

  try {
    const res = await fetch('datos/reflexion.json');
    datos = await res.json();

    // Rellenar opciones del <select>
    select.innerHTML = '<option value="">-- Elige un tema --</option>';
    for (const tema in datos) {
      const option = document.createElement('option');
      option.value = tema;
      option.textContent = tema.charAt(0).toUpperCase() + tema.slice(1);
      select.appendChild(option);
    }

    select.addEventListener('change', () => {
      const temaSeleccionado = select.value;
      if (temaSeleccionado && datos[temaSeleccionado]) {
        preguntasActuales = datos[temaSeleccionado];
        indiceActual = 0;
        mostrarPregunta();
      } else {
        contenedor.style.display = 'none';
      }
    });

    btnSiguiente.addEventListener('click', () => {
      indiceActual++;
      mostrarPregunta();
    });

    btnMostrarRespuesta.addEventListener('click', () => {
      if (preguntasActuales[indiceActual]) {
        divRespuesta.textContent = preguntasActuales[indiceActual].cita || 'No hay respuesta disponible.';
        divRespuesta.style.display = 'block';
        btnMostrarRespuesta.style.display = 'none';
      }
    });

  } catch (error) {
    console.error('Error cargando reflexion.json:', error);
  }

  function mostrarPregunta() {
    divRespuesta.style.display = 'none';
    btnMostrarRespuesta.style.display = 'inline-block';

    if (indiceActual < preguntasActuales.length) {
      const pregunta = preguntasActuales[indiceActual];
      preguntaTexto.textContent = `${indiceActual + 1}. ${pregunta.pregunta}`;
      contenedor.style.display = 'block';
      btnSiguiente.style.display = (indiceActual < preguntasActuales.length - 1) ? 'inline-block' : 'none';
    } else {
      preguntaTexto.textContent = '¡Has terminado todas las preguntas!';
      btnSiguiente.style.display = 'none';
      btnMostrarRespuesta.style.display = 'none';
      divRespuesta.style.display = 'none';
    }
  }
});
</script>

</body>
</html>
